{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "VerifiableAlignmentRecord",
  "type": "object",
  "required": [
    "var_version",
    "record_type",
    "record_id",
    "timestamp",
    "payload",
    "canonicalization",
    "hash",
    "signatures"
  ],
  "properties": {
    "var_version": { "type": "string", "enum": ["0.2"] },
    "record_type": {
      "type": "string",
      "enum": [
        "EVALUATION_EVENT",
        "AGREEMENT_PROPOSAL",
        "AGREEMENT_SIGNATURE",
        "AGREEMENT_REFUSAL",
        "POLICY_VERSION",
        "EPOCH_ROOT"
      ]
    },
    "record_id": { "type": "string" },
    "timestamp": { "type": "string", "format": "date-time" },
    "canonicalization": {
      "type": "object",
      "required": ["method"],
      "properties": {
        "method": { "type": "string", "enum": ["RFC8785_JCS", "CBOR_CANONICAL"] }
      }
    },
    "payload": { "type": "object" },
    "hash": {
      "type": "object",
      "required": ["alg", "value"],
      "properties": {
        "alg": { "type": "string", "enum": ["SHA-256"] },
        "value": { "type": "string" }
      }
    },
    "prev_hash": {
      "type": "object",
      "required": ["alg", "value"],
      "properties": {
        "alg": { "type": "string", "enum": ["SHA-256"] },
        "value": { "type": "string" }
      }
    },
    "signatures": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["kid", "alg", "sig"],
        "properties": {
          "kid": { "type": "string" },
          "alg": { "type": "string", "enum": ["Ed25519"] },
          "sig": { "type": "string" },
          "signer_role": {
            "type": "string",
            "enum": ["HUMAN", "AI_AGENT", "EVALUATOR", "WITNESS", "MAINTAINER"]
          }
        }
      }
    },
    "merkle": {
      "type": "object",
      "properties": {
        "root": { "type": "string" },
        "leaf": { "type": "string" },
        "path": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["direction", "hash"],
            "properties": {
              "direction": { "type": "string", "enum": ["LEFT", "RIGHT"] },
              "hash": { "type": "string" }
            }
          }
        }
      }
    }
  }
}
